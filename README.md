# SaekDongSan
색다른 동네 산책, 색동산!

색동산은 우리 동네에서 지도에 등록되어 있지 않은 장소들을 리뷰할 수 있는 새로운 리뷰 맵 페이지이다. 사용자는 자연 / 야경 등의 카테고리에 내 위치에 대한 기록을 사진과 함께 남길 수 있으며, 다른 사용자는 그 리뷰를 보고 좋아요, 댓글 기능을 통해 반응할 수 있다.  지도 위에는 사용자가 남긴 리뷰 속 사진을 통해 해당 위치를 표시하며, 그에 더해 누적된 리뷰들을 바탕으로  카테고리, 거리 등을 기준으로 하여  경로를 추천하는 기능을 지원한다.

# Mash-up Architecture
![mashuparchitecture](https://user-images.githubusercontent.com/65115422/138737700-3c5078c3-96ee-4463-8200-11cb198fc808.jpg)

# 전체 시스템 구성 
 
(1) Client Side 
- index.html 
: index.html에는 client가 접속하게 되면 보이는 가장 초기 화면을 initialize 하였다. 제목과 지도, 그리고 추가적인 조건들을 걸 수 있는 카테고리 선택 버튼, 산책코스 버튼 등이 있다. 
- index.js 
: index.html에서 사용하는 함수 등을 모두 initialize. 페이지가 로드되면서 실행되는 getLocation() 함수부터 시작하여 사용자들이 등록한 리뷰 가져오기, 현재 위치와 리뷰 장소 사이의 거리에 따른 필터링, 리뷰들을 표현할 포토마커 생성, 카테고리 별 리뷰 장소 안내, 보행자 경로 최적화, 길찾기 등과 같은 다양한 기능을 구현할 수 있게 하였다. 각각의 경우들은 해당하는 버튼 마다 click 하였을 때 버튼의 id에 따라 실행되는 코드들을 짜놓았다.
- newlocation.html 
: 리뷰 포스팅 시 현재 위치가 아닌 새로운 위치를 선택하고자 할 때 클릭하는 장소 위에 마커를 생성하고, 리뷰하는 장소가 그 새로 선택한 위치로 변환되도록 하는 새로운 창이 뜨게 하는 파일이다. 
- newlocation.js 
: 여러가지 함수들을 포함하고 있는 파일이다. 현재 유저의 로그인, 로그아웃을 체크하거나 유저가 새로운 리뷰를 작성하는 것을 총괄하거나, 마커를 클릭하였을 때 그 위치에 해당하는 리뷰들을 모아서 서버에서 가져오는 것을 총괄하는 함수들 등이 모두 모여있다.  
- main.css 
: 모든 css 관련 요소들에 대한 설정을 모아둔 곳이다. 포지션(윈도우 창에서 위치), 색깔, 크기, 글씨체 등등을 설정한다. 
- weather.js 
: 날씨 api를 이용하여, 현재 위치를 반영하여 사용자가 위치하는 도시의 기온을 안내한다.  
  
# Server Side 
- key.js, dev.js, prod.js 
: mongodb를 사용할 수 있는 key가 담겨져있는 key.js와 개발할 때 이런 키를 자유롭게 사용하는 dev.js, 그리고 배포할 때는 이러한 비밀정에 대한 접근을 막을 prod.js을 만들었다.
- dev.js, prod.js
: mongodb를 사용할 수 있는 key를 받아온다. 
- posting.js 
: 유저가 특정한 장소를 정하여 리뷰를 작성할 때, 그 리뷰를 서버에 저장시키는 schema를 포함하고 있는 js file이다. 
- user.js 
: 유저 정보를 저장하는 schema를 짜놓은 js file이다. 이메일, 이름, 그리고 좋아요를 누른 리뷰 등이 저장된다. 
- index.js 
: MongoDB를 실제로 connect하고, 서버를 실제로 구현한다. 유저가 실제로 로그인, 로그아웃을 할 수 있게 해주고, DB 속 user와 posting 정보를 가져와서 가공 후 클라이언트로 보낸다. 또한, 유저에서 온 정보들을 받아서 새로운 user, posting 객체를 만들거나 기존 내용을 update한다. 또 마커를 클릭하였을 때 그에 따라 리뷰들을 가져오고, 리뷰들의 좋아요/댓글 기능을 구현하여 준다. 마지막으로, 처음에 모든 data를 가져올 때 그것을 가능하게 해 주는 부분이 포함되어 있다. 
 
 
# 서비스 시나리오 별 실행 결과 
![1](https://user-images.githubusercontent.com/65115422/138739037-4d5b79e3-0611-4d63-b66a-05144046df89.JPG)
- 페이지 로드시 : 자신의 위치를 가져와 현재 위치 마커(red S)로 표시해주고, 반경 3km 이내의 모든 카테고리의 리뷰들을 포토마커형식으로 표시해준다. 또한 현재 위치의 날씨를 알려준다.

![2](https://user-images.githubusercontent.com/65115422/138739040-0f94594e-0f2b-4055-801b-8c6177bfaefb.JPG)
- 로그인 하기 : 구글 소셜 로그인을 이용하여, 사이트에 자신이 특정한 유저임을 밝힌다. 구글은 사용자의 아이디 토큰을 서버에 전달해 주고, 서버는 이를 이용하여  해당 사용자가 DB에 존재하는지 확인한다. 만약 존재하지 않을 경우 해당 사용자를 DB에 추가한다.
리뷰 남기기 등 여러 활동들을 하려면 로그인이 필수적이다.

![3](https://user-images.githubusercontent.com/65115422/138739041-65a70ac0-2776-4541-854d-678caad0cc77.JPG)
- 리뷰 등록하기 : 자신의 현재 위치 (또는 새로운 위치 선택 가능)에서 그 장소의 이름, 그 장소의 사진 그리고 설명과 함께 특정한 카테고리 중 하나를 선택하여 등록한다.
 특정한 장소만 리뷰가 가능한 것이 아니라, 지금껏 지나왔던 사소한 공간이라도 리뷰가 가능하다.

![4](https://user-images.githubusercontent.com/65115422/138739017-9a0f116a-4e0b-4e24-bb60-e0c0c5ead656.JPG)
- 전체 카테고리 중 한 카테고리 선택 후 적용하기 버튼 클릭 (ex. 야경이 예쁜 곳)
: 첫 화면에서 떠 있었던 포토마커들 중 선택한 카테고리에 속하는 포토마커들만 남는다.

![5](https://user-images.githubusercontent.com/65115422/138739026-3faf9d13-2945-4da7-a3b4-6fe3ccad5418.JPG)
- 포토마커를 선택한 후 리뷰보기 창 열람
: 해당 포토마커에 작성된 리뷰와 좋아요수, 좋아요를 누를 수 있는 LIKES 버튼과, 댓글창을 열 수 있는 COMMENT버튼이 모달창에 나타난다.

![6](https://user-images.githubusercontent.com/65115422/138739029-d33e87a4-1967-4bf7-8499-485c82b1f93d.JPG)
- 좋아요 누르기 및 댓글 작성하기
: COMMENT버튼을 눌러, 댓글을 확인하거나 추가할 수 있고, 댓글을 새로 달때마다 업데이트 된다.
좋아요 버튼을 1번 누를 경우 좋아요.  2번 누를 경우 취소로 한 사람당 1번만 표시할 수 있다. 좋아요 버튼이 눌려진 상태로 유지된다.

![7](https://user-images.githubusercontent.com/65115422/138739032-cfe6647e-9b42-4f29-bba3-f8829ae0fadc.JPG)
- (선택 1) 새로운 위치 선택하여 길찾기 
: 리뷰 모달창이 닫아지고, 지도 위에 원하는 새로운 위치를 클릭하면 그 위치부터 포토마커까지의 길을 탐색한다. 이때 보행자를 기준으로 걸리는 시간, 거리가 창에 출력된다.

![8](https://user-images.githubusercontent.com/65115422/138739033-cb83fcea-2b95-41db-a6be-1711d9d4134b.JPG)
- (선택 2) 현재 위치에서 길찾기 버튼 클릭
: 리뷰 모달창이 닫아지고, 현재 사용자의 위치부터 포토마커까지의 경로를 탐색한다. 

![9](https://user-images.githubusercontent.com/65115422/138739035-68041a8d-d1bd-4612-9d25-aeb2585806a5.JPG)
- 추천코스 버튼 클릭 후 경로 속성 적용하기:
남아있는 포토마커들 중 좋아요가 제일 높은 5개의 마커들을 가져와 경로 속성에 적합한 최적 경로를 산정하여 산책코스를 추천한다.


# 팀원 
- 강슬미 : 
  Google Oauth-Client-Server 연결, Tmap API 초기 Implementation, 마커 Event 등록하여 클릭 시 리뷰 받기, File API, 포스팅/ 포스팅 데이터 받기, 모달창 CSS, 리뷰 작성하는 / 보는 모달창 만들기, 댓글창 구현, 날씨 API, 앱 배포 등 
- 박서정 :
   Mongo DB와 서버 연결하여 user와 posting object를 생성 및 관리. user와 posting 데이터들을 클라이언트와 서버 사이에 송수신 구현,  google oauth 토큰 기반 인증 시스템 구현, 이미지 데이터 송수신하는 system, Geolocation API, 좋아요 구현, 메인페이지 CSS 등 
- 신수빈 :
  Tmap 길찾기 API, 마커표시 반경 3km 내(“동네”) 설정, 마커 포토마커로 바꾸기, 초기 CSS, 지도에 마커 표시, 마커 Event 등록하여 클릭 시 리뷰 받기 등 
- 유재인 :
  Tmap 경로 최적화 API/직선거리 사용하여 경유지 최적화, 지도에 마커 표시, 마커 포토마커로 바꾸기, 마커 Event 등록하여 클릭 시 리뷰 받기 등 

